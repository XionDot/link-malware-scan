import requests
import json

def enrich_url(url):
    # Initialize the result dictionary to store enriched information
    enrichment_result = {"url": url, "enrichment": {}}

    try:
        # Fetch additional information from a threat intelligence API (replace with actual API details)
        threat_api_url = "https://threat-intelligence-api.com/api/lookup"
        api_key = "your_api_key_here"  # Replace with your actual API key
        params = {"url": url, "api_key": api_key}

        # Make a GET request to the threat intelligence API
        response = requests.get(threat_api_url, params=params)

        # Check if the request was successful (status code 200)
        if response.status_code == 200:
            # Parse the JSON response
            threat_info = response.json()

            # Extract relevant information from the API response and add it to the result dictionary
            enrichment_result["enrichment"]["threat_level"] = threat_info.get("threat_level", "Unknown")
            enrichment_result["enrichment"]["malware_family"] = threat_info.get("malware_family", "Unknown")

        else:
            # Handle the case where the API request was not successful
            enrichment_result["enrichment"]["error"] = f"Failed to fetch information. Status Code: {response.status_code}"

    except Exception as e:
        # Handle general exceptions (e.g., network issues, JSON parsing errors)
        enrichment_result["enrichment"]["error"] = f"An error occurred: {str(e)}"

    return enrichment_result

def main():
    # Prompt the user to input a URL
    malicious_url = input("Enter the malicious URL: ")
    
    # Call the enrich_url function with the user-provided URL
    result = enrich_url(malicious_url)

    # Display the enriched information
    print(json.dumps(result, indent=2))

if __name__ == "__main__":
    main()
